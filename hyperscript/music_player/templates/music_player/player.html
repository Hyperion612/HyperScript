{% extends 'base.html' %}

{% block title %}–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–π –ø–ª–µ–µ—Ä - HyperScript{% endblock %}

{% block content %}
<div class="container">
    <h1 class="text-center mb-4">üéµ –ú—É–∑—ã–∫–∞–ª—å–Ω—ã–π –ø–ª–µ–µ—Ä</h1>
    
    <div class="row">
        <!-- –ó–∞–≥—Ä—É–∑–∫–∞ –º—É–∑—ã–∫–∏ -->
        <div class="col-md-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å –º—É–∑—ã–∫—É</h5>
                </div>
                <div class="card-body">
                    <form method="post" enctype="multipart/form-data">
                        {% csrf_token %}
                        <div class="mb-3">
                            <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞ *</label>
                            <input type="text" name="title" class="form-control" required maxlength="200">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å</label>
                            <input type="text" name="artist" class="form-control" maxlength="200">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">–ê—É–¥–∏–æ —Ñ–∞–π–ª *</label>
                            <input type="file" name="audio_file" class="form-control" accept="audio/*" required>
                            <div class="form-text">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: MP3, WAV, OGG</div>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                    </form>
                </div>
            </div>

            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–ª–µ–µ—Ä–æ–º -->
            <div class="card mt-4">
                <div class="card-header">
                    <h6 class="mb-0">üéõÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–ª–µ–µ—Ä–æ–º</h6>
                </div>
                <div class="card-body">
                    <div class="d-grid gap-2">
                        <button onclick="toggleRepeat()" class="btn btn-outline-info btn-sm">
                            üîÅ –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –ø–æ–≤—Ç–æ—Ä
                        </button>
                        <button onclick="stopGlobalPlayback()" class="btn btn-outline-danger btn-sm">
                            ‚úñ –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å—ë
                        </button>
                    </div>
                    <div class="mt-3">
                        <small class="text-muted">
                            üí° –ú—É–∑—ã–∫–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –∏–≥—Ä–∞—Ç—å –¥–∞–∂–µ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã!
                        </small>
                    </div>
                </div>
            </div>
        </div>

        <!-- –°–ø–∏—Å–æ–∫ —Ç—Ä–µ–∫–æ–≤ -->
        <div class="col-md-8">
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">üé∂ –ú–æ—è –º—É–∑—ã–∫–∞</h5>
                    <span class="badge bg-primary">{{ tracks.count }} —Ç—Ä–µ–∫–æ–≤</span>
                </div>
                <div class="card-body">
                    {% if tracks %}
                        <div class="list-group">
                            {% for track in tracks %}
                            <div class="list-group-item">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="flex-grow-1">
                                        <h6 class="mb-1">{{ track.title }}</h6>
                                        <small class="text-muted">
                                            {% if track.artist %}{{ track.artist }} ‚Ä¢ {% endif %}
                                            {{ track.uploaded_at|date:"d.m.Y H:i" }}
                                        </small>
                                    </div>
                                    <div class="btn-group ms-3">
                                        <button onclick="playGlobal('{{ track.audio_file.url }}', '{{ track.title }}')" 
                                                class="btn btn-sm btn-success">‚ñ∂ –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏</button>
                                        <a href="{% url 'delete_track' track.id %}" 
                                           class="btn btn-sm btn-danger"
                                           onclick="return confirm('–£–¥–∞–ª–∏—Ç—å —Ç—Ä–µ–∫ &quot;{{ track.title }}&quot;?')">üóë –£–¥–∞–ª–∏—Ç—å</a>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <div class="text-center py-4">
                            <div class="h1 text-muted mb-3">üéµ</div>
                            <p class="text-muted">–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–π –º—É–∑—ã–∫–∏</p>
                            <p class="text-muted small">–ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø–µ—Ä–≤—ã–π —Ç—Ä–µ–∫ —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Å–ª—É—à–∞—Ç—å –º—É–∑—ã–∫—É</p>
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–ª–µ–µ—Ä–µ -->
            <div class="card mt-4">
                <div class="card-body">
                    <h6>üéß –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–ª–µ–µ—Ä</h6>
                    <ul class="small mb-0">
                        <li>–ú—É–∑—ã–∫–∞ –∏–≥—Ä–∞–µ—Ç –≤ –≤–µ—Ä—Ö–Ω–µ–π –ø–∞–Ω–µ–ª–∏ –Ω–∞ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö</li>
                        <li>–í–∫–ª—é—á–∏—Ç–µ üîÅ –ü–æ–≤—Ç–æ—Ä –¥–ª—è –∑–∞—Ü–∏–∫–ª–∏–≤–∞–Ω–∏—è —Ç—Ä–µ–∫–∞</li>
                        <li>–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã</li>
                        <li>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –≤—Å–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∞—É–¥–∏–æ—Ñ–æ—Ä–º–∞—Ç—ã</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.list-group-item {
    border: 1px solid rgba(0,0,0,.125);
    margin-bottom: 0.5rem;
    border-radius: 0.375rem;
    transition: all 0.2s;
}
.list-group-item:hover {
    background-color: #f8f9fa;
}
.btn-group .btn {
    margin-left: 0.25rem;
}
</style>
{% endblock %}