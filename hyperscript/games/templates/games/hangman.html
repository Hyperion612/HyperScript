{% extends 'base.html' %}

{% block title %}–í–∏—Å–µ–ª–∏—Ü–∞ - HyperScript{% endblock %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title mb-0">üéÆ –í–∏—Å–µ–ª–∏—Ü–∞</h3>
                </div>
                
                <div class="card-body text-center">
                    
                    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                    <div class="row mb-4">
                        <div class="col-6">
                            <div class="border rounded p-2">
                                <small>–û—à–∏–±–æ–∫</small>
                                <div class="h4 mb-0 {% if wrong_guesses >= 5 %}text-danger{% else %}text-warning{% endif %}">
                                    {{ wrong_guesses }} / {{ max_wrong }}
                                </div>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="border rounded p-2">
                                <small>–î–ª–∏–Ω–∞ —Å–ª–æ–≤–∞</small>
                                <div class="h4 mb-0 text-info">{{ word_length }} –±—É–∫–≤</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- –í–∏—Å–µ–ª–∏—Ü–∞ (ASCII –∞—Ä—Ç) -->
                    <div class="mb-4" style="font-family: monospace; font-size: 1.2rem;">
                        <pre>
  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
  ‚îÇ     {{ "O" if wrong_guesses > 0 else " " }}
  ‚îÇ    {{ "/" if wrong_guesses > 2 else " " }}{{ "|" if wrong_guesses > 1 else " " }}{{ "\\" if wrong_guesses > 3 else " " }}
  ‚îÇ    {{ "/" if wrong_guesses > 4 else " " }} {{ "\\" if wrong_guesses > 5 else " " }}
  ‚îÇ
‚îå‚îÄ‚î¥‚îÄ‚îê
                        </pre>
                    </div>
                    
                    <!-- –ó–∞–≥–∞–¥–∞–Ω–Ω–æ–µ —Å–ª–æ–≤–æ -->
                    <div class="mb-4">
                        <h2 class="display-4 letter-spacing-2">{{ display_word }}</h2>
                        <p class="text-muted">–£–≥–∞–¥–∞–π—Ç–µ —Å–ª–æ–≤–æ –ø–æ –±—É–∫–≤–∞–º</p>
                    </div>
                    
                    {% if game_over %}
                        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç –∏–≥—Ä—ã -->
                        <div class="alert {% if won %}alert-success{% else %}alert-danger{% endif %} mb-4">
                            <h4>
                                {% if won %}
                                    üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏!
                                {% else %}
                                    üíÄ –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!
                                {% endif %}
                            </h4>
                            <p class="mb-0">
                                –ó–∞–≥–∞–¥–∞–Ω–Ω–æ–µ —Å–ª–æ–≤–æ: <strong>{{ display_word|replace:"_ " }}</strong>
                            </p>
                        </div>
                        
                        <form method="POST">
                            {% csrf_token %}
                            <input type="hidden" name="new_game" value="1">
                            <button type="submit" class="btn btn-primary btn-lg">
                                üöÄ –ù–æ–≤–∞—è –∏–≥—Ä–∞
                            </button>
                        </form>
                        
                    {% else %}
                        <!-- –í—ã–±–æ—Ä –±—É–∫–≤ -->
                        <div class="mb-4">
                            <h5>–í—ã–±–µ—Ä–∏—Ç–µ –±—É–∫–≤—É:</h5>
                            <div class="d-flex flex-wrap justify-content-center gap-2 mb-3">
                                {% for letter in remaining_letters|slice:":13" %}
                                <form method="POST" style="display: inline;">
                                    {% csrf_token %}
                                    <input type="hidden" name="letter" value="{{ letter }}">
                                    <button type="submit" class="btn btn-outline-primary btn-letter">
                                        {{ letter }}
                                    </button>
                                </form>
                                {% endfor %}
                            </div>
                            <div class="d-flex flex-wrap justify-content-center gap-2">
                                {% for letter in remaining_letters|slice:"13:" %}
                                <form method="POST" style="display: inline;">
                                    {% csrf_token %}
                                    <input type="hidden" name="letter" value="{{ letter }}">
                                    <button type="submit" class="btn btn-outline-primary btn-letter">
                                        {{ letter }}
                                    </button>
                                </form>
                                {% endfor %}
                            </div>
                        </div>
                        
                        <!-- –£–∂–µ —É–≥–∞–¥–∞–Ω–Ω—ã–µ –±—É–∫–≤—ã -->
                        {% if guessed_letters %}
                        <div class="mb-4">
                            <small>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –±—É–∫–≤—ã:</small>
                            <p class="h5 text-muted">{{ guessed_letters }}</p>
                        </div>
                        {% endif %}
                        
                        <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∞ -->
                        <div class="alert alert-info">
                            <small>
                                üí° <strong>–ü—Ä–∞–≤–∏–ª–∞:</strong> –£–≥–∞–¥—ã–≤–∞–π—Ç–µ —Å–ª–æ–≤–æ –ø–æ –±—É–∫–≤–∞–º. 
                                –ú–∞–∫—Å–∏–º—É–º {{ max_wrong }} –æ—à–∏–±–æ–∫. –í—Å–µ –±—É–∫–≤—ã –∑–∞–≥–ª–∞–≤–Ω—ã–µ, —Ä—É—Å—Å–∫–æ–≥–æ –∞–ª—Ñ–∞–≤–∏—Ç–∞.
                            </small>
                        </div>
                    {% endif %}
                    
                    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
                    <div class="mt-4">
                        <a href="{% url 'games_index' %}" class="btn btn-outline-secondary">
                            ‚Üê –ù–∞–∑–∞–¥ –∫ –∏–≥—Ä–∞–º
                        </a>
                    </div>
                    
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.letter-spacing-2 {
    letter-spacing: 10px;
}

.btn-letter {
    width: 45px;
    height: 45px;
    font-weight: bold;
    transition: all 0.2s;
}

.btn-letter:hover {
    transform: scale(1.1);
}

pre {
    background: #f8f9fa;
    padding: 15px;
    border-radius: 10px;
    display: inline-block;
}

@media (max-width: 768px) {
    .letter-spacing-2 {
        letter-spacing: 5px;
        font-size: 1.8rem;
    }
    
    .btn-letter {
        width: 40px;
        height: 40px;
        font-size: 0.9rem;
    }
}
</style>
{% endblock %}