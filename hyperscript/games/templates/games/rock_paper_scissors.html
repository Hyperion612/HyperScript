{% extends 'base.html' %}

{% block title %}–ö–∞–º–µ–Ω—å-–ù–æ–∂–Ω–∏—Ü—ã-–ë—É–º–∞–≥–∞ - HyperScript{% endblock %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title mb-0">üéÆ –ö–∞–º–µ–Ω—å-–ù–æ–∂–Ω–∏—Ü—ã-–ë—É–º–∞–≥–∞</h3>
                </div>
                <div class="card-body text-center">
                    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                    <div class="row mb-4">
                        <div class="col-4">
                            <div class="border rounded p-2">
                                <small>–ü–æ–±–µ–¥—ã</small>
                                <div class="h4 mb-0 text-success" id="wins">0</div>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="border rounded p-2">
                                <small>–ü–æ—Ä–∞–∂–µ–Ω–∏—è</small>
                                <div class="h4 mb-0 text-danger" id="losses">0</div>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="border rounded p-2">
                                <small>–ù–∏—á—å–∏</small>
                                <div class="h4 mb-0 text-warning" id="draws">0</div>
                            </div>
                        </div>
                    </div>

                    <!-- –ö–Ω–æ–ø–∫–∞ –ù–∞—á–∞—Ç—å -->
                    <div class="mb-4" id="startButtonContainer">
                        <button class="btn btn-success btn-lg" id="startGameBtn">
                            üöÄ –ù–∞—á–∞—Ç—å –∏–≥—Ä—É
                        </button>
                    </div>

                    <!-- –í—ã–±–æ—Ä —Ö–æ–¥–∞ (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç) -->
                    <div id="gameArea" style="display: none;">
                        <div class="mb-4">
                            <h5>–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à —Ö–æ–¥:</h5>
                            <div class="btn-group btn-group-lg" role="group">
                                <button type="button" class="btn btn-outline-primary choice-btn" data-choice="rock">
                                    ‚úä –ö–∞–º–µ–Ω—å
                                </button>
                                <button type="button" class="btn btn-outline-success choice-btn" data-choice="paper">
                                    ‚úã –ë—É–º–∞–≥–∞
                                </button>
                                <button type="button" class="btn btn-outline-warning choice-btn" data-choice="scissors">
                                    ‚úåÔ∏è –ù–æ–∂–Ω–∏—Ü—ã
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—É–Ω–¥–∞ -->
                    <div id="resultArea" style="display: none;">
                        <div class="row align-items-center mb-4">
                            <div class="col-5 text-end">
                                <div class="h3" id="userChoiceDisplay"></div>
                                <small>–í–∞—à —Ö–æ–¥</small>
                            </div>
                            <div class="col-2">
                                <div class="h4 text-muted">VS</div>
                            </div>
                            <div class="col-5 text-start">
                                <div class="h3" id="computerChoiceDisplay"></div>
                                <small>–ö–æ–º–ø—å—é—Ç–µ—Ä</small>
                            </div>
                        </div>

                        <div class="alert mb-4" id="resultAlert">
                            <h4 id="resultText" class="mb-0"></h4>
                        </div>

                        <div class="d-grid gap-2 d-md-block">
                            <button class="btn btn-primary btn-lg me-2" id="playAgainBtn">
                                üîÑ –ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞
                            </button>
                            <button class="btn btn-outline-secondary btn-lg" id="backToMenuBtn">
                                üìã –í –º–µ–Ω—é
                            </button>
                        </div>
                    </div>

                    <!-- –°—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω -->
                    <div id="startArea">
                        <div class="py-4">
                            <!-- –ó–∞–º–µ–Ω–∏–ª Font Awesome –Ω–∞ —ç–º–æ–¥–∑–∏ -->
                            <div class="display-1 mb-3">‚úä‚úã‚úåÔ∏è</div>
                            <h4>–ì–æ—Ç–æ–≤—ã —Å—ã–≥—Ä–∞—Ç—å?</h4>
                            <p class="text-muted">–ù–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å –∏–≥—Ä—É" —á—Ç–æ–±—ã —Å—ã–≥—Ä–∞—Ç—å –≤ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫—É—é –∏–≥—Ä—É –ø—Ä–æ—Ç–∏–≤ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞</p>
                            <div class="mt-4">
                                <div class="row text-center">
                                    <div class="col-4">
                                        <!-- –ó–∞–º–µ–Ω–∏–ª Font Awesome –Ω–∞ —ç–º–æ–¥–∑–∏ -->
                                        <div class="h1 text-primary mb-2">ü§ñ</div>
                                        <div class="fw-bold">–ü—Ä–æ—Ç–∏–≤ –ò–ò</div>
                                        <small class="text-muted">–£–º–Ω—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä</small>
                                    </div>
                                    <div class="col-4">
                                        <!-- –ó–∞–º–µ–Ω–∏–ª Font Awesome –Ω–∞ —ç–º–æ–¥–∑–∏ -->
                                        <div class="h1 text-warning mb-2">üèÜ</div>
                                        <div class="fw-bold">–ë–µ—Å–∫–æ–Ω–µ—á–Ω–æ</div>
                                        <small class="text-muted">–°–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ —Ä–∞—É–Ω–¥–æ–≤</small>
                                    </div>
                                    <div class="col-4">
                                        <!-- –ó–∞–º–µ–Ω–∏–ª Font Awesome –Ω–∞ —ç–º–æ–¥–∑–∏ -->
                                        <div class="h1 text-success mb-2">üìà</div>
                                        <div class="fw-bold">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
                                        <small class="text-muted">–°–ª–µ–¥–∏—Ç–µ –∑–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∏ –Ω–∞–¥–µ–∂–Ω–∞—è –≤–µ—Ä—Å–∏—è –∏–≥—Ä—ã
document.addEventListener('DOMContentLoaded', function() {
    console.log('üéÆ –ò–≥—Ä–∞ "–ö–∞–º–µ–Ω—å-–ù–æ–∂–Ω–∏—Ü—ã-–ë—É–º–∞–≥–∞" –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...');
    
    // –û—Å–Ω–æ–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
    const elements = {
        startBtn: document.getElementById('startGameBtn'),
        gameArea: document.getElementById('gameArea'),
        resultArea: document.getElementById('resultArea'),
        startArea: document.getElementById('startArea'),
        playAgainBtn: document.getElementById('playAgainBtn'),
        backToMenuBtn: document.getElementById('backToMenuBtn'),
        choiceBtns: document.querySelectorAll('.choice-btn'),
        userChoiceDisplay: document.getElementById('userChoiceDisplay'),
        computerChoiceDisplay: document.getElementById('computerChoiceDisplay'),
        resultAlert: document.getElementById('resultAlert'),
        resultText: document.getElementById('resultText'),
        winsEl: document.getElementById('wins'),
        lossesEl: document.getElementById('losses'),
        drawsEl: document.getElementById('draws')
    };
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã
    console.log('–ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤:');
    Object.entries(elements).forEach(([name, element]) => {
        if (Array.isArray(element) || (element && element.length)) {
            console.log(`  ${name}: ${element.length} —ç–ª–µ–º–µ–Ω—Ç–æ–≤`);
        } else {
            console.log(`  ${name}: ${element ? '‚úì –Ω–∞–π–¥–µ–Ω' : '‚úó –Ω–µ –Ω–∞–π–¥–µ–Ω'}`);
        }
    });
    
    // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä—ã
    let gameState = {
        wins: 0,
        losses: 0,
        draws: 0,
        isPlaying: false
    };
    
    // --- –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô ---
    
    // 1. –ö–Ω–æ–ø–∫–∞ "–ù–∞—á–∞—Ç—å –∏–≥—Ä—É"
    if (elements.startBtn) {
        elements.startBtn.addEventListener('click', function() {
            console.log('‚ñ∂ –ù–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞ "–ù–∞—á–∞—Ç—å –∏–≥—Ä—É"');
            startGame();
        });
        
        // –î–æ–±–∞–≤–ª—è–µ–º –≤–∏–∑—É–∞–ª—å–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å
        elements.startBtn.addEventListener('mouseenter', function() {
            this.style.transform = 'scale(1.05)';
        });
        
        elements.startBtn.addEventListener('mouseleave', function() {
            this.style.transform = 'scale(1)';
        });
    }
    
    // 2. –ö–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ —Ö–æ–¥–∞
    if (elements.choiceBtns.length > 0) {
        elements.choiceBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                if (!gameState.isPlaying) {
                    alert('–°–Ω–∞—á–∞–ª–∞ –Ω–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å –∏–≥—Ä—É"!');
                    return;
                }
                
                const userChoice = this.getAttribute('data-choice');
                console.log(`üéØ –í—ã–±–æ—Ä –∏–≥—Ä–æ–∫–∞: ${userChoice}`);
                playRound(userChoice);
            });
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
            btn.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-3px)';
                this.style.boxShadow = '0 5px 15px rgba(0,0,0,0.2)';
            });
            
            btn.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
                this.style.boxShadow = 'none';
            });
        });
    }
    
    // 3. –ö–Ω–æ–ø–∫–∞ "–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞"
    if (elements.playAgainBtn) {
        elements.playAgainBtn.addEventListener('click', function() {
            console.log('üîÑ –ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞');
            showGameArea();
        });
    }
    
    // 4. –ö–Ω–æ–ø–∫–∞ "–í –º–µ–Ω—é"
    if (elements.backToMenuBtn) {
        elements.backToMenuBtn.addEventListener('click', function() {
            console.log('üìã –í–æ–∑–≤—Ä–∞—Ç –≤ –º–µ–Ω—é');
            resetToMenu();
        });
    }
    
    // --- –§–£–ù–ö–¶–ò–ò –ò–ì–†–´ ---
    
    function startGame() {
        console.log('üöÄ –ó–∞–ø—É—Å–∫ –Ω–æ–≤–æ–π –∏–≥—Ä—ã');
        
        gameState.isPlaying = true;
        gameState.wins = 0;
        gameState.losses = 0;
        gameState.draws = 0;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–≥—Ä–æ–≤—É—é –æ–±–ª–∞—Å—Ç—å
        if (elements.startArea) {
            elements.startArea.style.display = 'none';
        }
        
        if (elements.startBtn) {
            elements.startBtn.style.display = 'none';
        }
        
        if (elements.gameArea) {
            elements.gameArea.style.display = 'block';
            elements.gameArea.style.opacity = '0';
            setTimeout(() => {
                elements.gameArea.style.opacity = '1';
                elements.gameArea.style.transition = 'opacity 0.5s ease';
            }, 10);
        }
        
        if (elements.resultArea) {
            elements.resultArea.style.display = 'none';
        }
        
        updateStatsDisplay();
        console.log('‚úÖ –ò–≥—Ä–∞ –Ω–∞—á–∞—Ç–∞!');
    }
    
    function playRound(userChoice) {
        console.log(`üéÆ –†–∞—É–Ω–¥: –∏–≥—Ä–æ–∫ –≤—ã–±—Ä–∞–ª ${userChoice}`);
        
        // –í–æ–∑–º–æ–∂–Ω—ã–µ —Ö–æ–¥—ã
        const choices = ['rock', 'paper', 'scissors'];
        const choiceNames = {
            'rock': '‚úä –ö–∞–º–µ–Ω—å',
            'paper': '‚úã –ë—É–º–∞–≥–∞',
            'scissors': '‚úåÔ∏è –ù–æ–∂–Ω–∏—Ü—ã'
        };
        
        // –í—ã–±–æ—Ä –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
        const computerChoice = choices[Math.floor(Math.random() * 3)];
        console.log(`üíª –ö–æ–º–ø—å—é—Ç–µ—Ä –≤—ã–±—Ä–∞–ª: ${computerChoice}`);
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
        let result, message, alertClass;
        
        if (userChoice === computerChoice) {
            result = 'draw';
            message = 'ü§ù –ù–∏—á—å—è!';
            alertClass = 'alert-warning';
            gameState.draws++;
            console.log('ü§ù –†–µ–∑—É–ª—å—Ç–∞—Ç: –Ω–∏—á—å—è');
        } else if (
            (userChoice === 'rock' && computerChoice === 'scissors') ||
            (userChoice === 'scissors' && computerChoice === 'paper') ||
            (userChoice === 'paper' && computerChoice === 'rock')
        ) {
            result = 'win';
            message = 'üéâ –í—ã –ø–æ–±–µ–¥–∏–ª–∏!';
            alertClass = 'alert-success';
            gameState.wins++;
            console.log('üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø–æ–±–µ–¥–∞ –∏–≥—Ä–æ–∫–∞');
        } else {
            result = 'lose';
            message = 'üíª –ö–æ–º–ø—å—é—Ç–µ—Ä –ø–æ–±–µ–¥–∏–ª!';
            alertClass = 'alert-danger';
            gameState.losses++;
            console.log('üíª –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø–æ–±–µ–¥–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞');
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        updateStatsDisplay();
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        showRoundResult(userChoice, computerChoice, choiceNames, message, alertClass);
    }
    
    function showRoundResult(userChoice, computerChoice, choiceNames, message, alertClass) {
        // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞
        if (elements.userChoiceDisplay) {
            elements.userChoiceDisplay.textContent = choiceNames[userChoice];
        }
        
        if (elements.computerChoiceDisplay) {
            elements.computerChoiceDisplay.textContent = choiceNames[computerChoice];
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
        if (elements.resultAlert && elements.resultText) {
            elements.resultAlert.className = `alert ${alertClass}`;
            elements.resultText.textContent = message;
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —ç–∫—Ä–∞–Ω—ã
        if (elements.gameArea) {
            elements.gameArea.style.display = 'none';
        }
        
        if (elements.resultArea) {
            elements.resultArea.style.display = 'block';
            elements.resultArea.style.opacity = '0';
            
            // –ü–ª–∞–≤–Ω–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ
            setTimeout(() => {
                elements.resultArea.style.opacity = '1';
                elements.resultArea.style.transition = 'opacity 0.5s ease';
            }, 10);
        }
        
        console.log('üìä –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–∫–∞–∑–∞–Ω');
    }
    
    function showGameArea() {
        console.log('üîÑ –í–æ–∑–≤—Ä–∞—Ç –∫ –≤—ã–±–æ—Ä—É —Ö–æ–¥–∞');
        
        if (elements.gameArea) {
            elements.gameArea.style.display = 'block';
            elements.gameArea.style.opacity = '0';
            setTimeout(() => {
                elements.gameArea.style.opacity = '1';
            }, 10);
        }
        
        if (elements.resultArea) {
            elements.resultArea.style.display = 'none';
        }
    }
    
    function resetToMenu() {
        console.log('üìã –°–±—Ä–æ—Å –∫ –Ω–∞—á–∞–ª—å–Ω–æ–º—É —ç–∫—Ä–∞–Ω—É');
        
        gameState.isPlaying = false;
        
        if (elements.startArea) {
            elements.startArea.style.display = 'block';
        }
        
        if (elements.startBtn) {
            elements.startBtn.style.display = 'block';
        }
        
        if (elements.gameArea) {
            elements.gameArea.style.display = 'none';
        }
        
        if (elements.resultArea) {
            elements.resultArea.style.display = 'none';
        }
        
        // –°–±—Ä–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        gameState.wins = 0;
        gameState.losses = 0;
        gameState.draws = 0;
        updateStatsDisplay();
    }
    
    function updateStatsDisplay() {
        console.log(`üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: ${gameState.wins}-${gameState.losses}-${gameState.draws}`);
        
        if (elements.winsEl) {
            elements.winsEl.textContent = gameState.wins;
        }
        
        if (elements.lossesEl) {
            elements.lossesEl.textContent = gameState.losses;
        }
        
        if (elements.drawsEl) {
            elements.drawsEl.textContent = gameState.draws;
        }
    }
    
    // –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ
    console.log('‚úÖ –ò–≥—Ä–∞ "–ö–∞–º–µ–Ω—å-–ù–æ–∂–Ω–∏—Ü—ã-–ë—É–º–∞–≥–∞" –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!');
    console.log('üëâ –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ù–∞—á–∞—Ç—å –∏–≥—Ä—É" —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å');
});
</script>

<style>
/* –°—Ç–∏–ª–∏ –¥–ª—è –∏–≥—Ä—ã */
.choice-btn {
    transition: all 0.3s ease;
    min-width: 120px;
    padding: 15px 20px;
    border-radius: 10px;
    font-weight: bold;
    margin: 5px;
}

.choice-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

#userChoiceDisplay, #computerChoiceDisplay {
    font-size: 2.5rem;
    margin-bottom: 10px;
}

.alert {
    border: none;
    border-radius: 15px;
    padding: 20px;
    margin: 20px 0;
}

#startGameBtn {
    padding: 15px 40px;
    font-size: 1.3rem;
    border-radius: 50px;
    transition: all 0.3s ease;
}

#startGameBtn:hover {
    transform: scale(1.05);
    box-shadow: 0 10px 20px rgba(0,0,0,0.2);
}

/* –ü–ª–∞–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã */
#gameArea, #resultArea, #startArea {
    transition: opacity 0.5s ease;
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
@media (max-width: 768px) {
    .btn-group {
        flex-direction: column;
        width: 100%;
    }
    
    .choice-btn {
        width: 100%;
        margin: 5px 0;
    }
    
    #userChoiceDisplay, #computerChoiceDisplay {
        font-size: 2rem;
    }
    
    .row.align-items-center {
        flex-direction: column;
        text-align: center;
    }
    
    .col-5, .col-2 {
        width: 100%;
        text-align: center !important;
        margin-bottom: 10px;
    }
}
</style>
{% endblock %}