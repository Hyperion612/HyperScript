{% extends 'base.html' %}

{% block title %}–ö–∞–º–µ–Ω—å-–ù–æ–∂–Ω–∏—Ü—ã-–ë—É–º–∞–≥–∞ - HyperScript{% endblock %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title mb-0">üéÆ –ö–∞–º–µ–Ω—å-–ù–æ–∂–Ω–∏—Ü—ã-–ë—É–º–∞–≥–∞</h3>
                </div>
                <div class="card-body text-center">
                    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                    <div class="row mb-4">
                        <div class="col-4">
                            <div class="border rounded p-2">
                                <small>–ü–æ–±–µ–¥—ã</small>
                                <div class="h4 mb-0 text-success" id="wins">0</div>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="border rounded p-2">
                                <small>–ü–æ—Ä–∞–∂–µ–Ω–∏—è</small>
                                <div class="h4 mb-0 text-danger" id="losses">0</div>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="border rounded p-2">
                                <small>–ù–∏—á—å–∏</small>
                                <div class="h4 mb-0 text-warning" id="draws">0</div>
                            </div>
                        </div>
                    </div>

                    <!-- –ö–Ω–æ–ø–∫–∞ –ù–∞—á–∞—Ç—å -->
                    <div class="mb-4">
                        <button class="btn btn-success btn-lg" id="startGameBtn">
                            üöÄ –ù–∞—á–∞—Ç—å –∏–≥—Ä—É
                        </button>
                    </div>

                    <!-- –í—ã–±–æ—Ä —Ö–æ–¥–∞ (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç) -->
                    <div id="gameArea" style="display: none;">
                        <div class="mb-4">
                            <h5>–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à —Ö–æ–¥:</h5>
                            <div class="btn-group btn-group-lg" role="group">
                                <button type="button" class="btn btn-outline-primary choice-btn" data-choice="rock">
                                    ‚úä –ö–∞–º–µ–Ω—å
                                </button>
                                <button type="button" class="btn btn-outline-success choice-btn" data-choice="paper">
                                    ‚úã –ë—É–º–∞–≥–∞
                                </button>
                                <button type="button" class="btn btn-outline-warning choice-btn" data-choice="scissors">
                                    ‚úåÔ∏è –ù–æ–∂–Ω–∏—Ü—ã
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—É–Ω–¥–∞ -->
                    <div id="resultArea" style="display: none;">
                        <div class="row align-items-center mb-4">
                            <div class="col-5 text-end">
                                <div class="h3" id="userChoiceDisplay"></div>
                                <small>–í–∞—à —Ö–æ–¥</small>
                            </div>
                            <div class="col-2">
                                <div class="h4 text-muted">VS</div>
                            </div>
                            <div class="col-5 text-start">
                                <div class="h3" id="computerChoiceDisplay"></div>
                                <small>–ö–æ–º–ø—å—é—Ç–µ—Ä</small>
                            </div>
                        </div>

                        <div class="alert mb-4" id="resultAlert">
                            <h4 id="resultText" class="mb-0"></h4>
                        </div>

                        <div class="d-grid gap-2 d-md-block">
                            <button class="btn btn-primary btn-lg me-2" id="playAgainBtn">
                                üîÑ –ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞
                            </button>
                            <button class="btn btn-outline-secondary btn-lg" id="backToMenuBtn">
                                üìã –í –º–µ–Ω—é
                            </button>
                        </div>
                    </div>

                    <!-- –°—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω -->
                    <div id="startArea">
                        <div class="py-4">
                            <i class="fas fa-hand-rock fa-4x text-muted mb-3"></i>
                            <h4>–ì–æ—Ç–æ–≤—ã —Å—ã–≥—Ä–∞—Ç—å?</h4>
                            <p class="text-muted">–ù–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å –∏–≥—Ä—É" —á—Ç–æ–±—ã —Å—ã–≥—Ä–∞—Ç—å –≤ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫—É—é –∏–≥—Ä—É –ø—Ä–æ—Ç–∏–≤ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞</p>
                            <div class="mt-4">
                                <div class="row text-center">
                                    <div class="col-4">
                                        <i class="fas fa-robot text-primary fa-2x mb-2"></i>
                                        <div class="fw-bold">–ü—Ä–æ—Ç–∏–≤ –ò–ò</div>
                                        <small class="text-muted">–£–º–Ω—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä</small>
                                    </div>
                                    <div class="col-4">
                                        <i class="fas fa-trophy text-warning fa-2x mb-2"></i>
                                        <div class="fw-bold">–ë–µ—Å–∫–æ–Ω–µ—á–Ω–æ</div>
                                        <small class="text-muted">–°–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ —Ä–∞—É–Ω–¥–æ–≤</small>
                                    </div>
                                    <div class="col-4">
                                        <i class="fas fa-chart-line text-success fa-2x mb-2"></i>
                                        <div class="fw-bold">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
                                        <small class="text-muted">–°–ª–µ–¥–∏—Ç–µ –∑–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // –≠–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    const startGameBtn = document.getElementById('startGameBtn');
    const gameArea = document.getElementById('gameArea');
    const resultArea = document.getElementById('resultArea');
    const startArea = document.getElementById('startArea');
    const choiceBtns = document.querySelectorAll('.choice-btn');
    const playAgainBtn = document.getElementById('playAgainBtn');
    const backToMenuBtn = document.getElementById('backToMenuBtn');
    
    // –≠–ª–µ–º–µ–Ω—Ç—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    const userChoiceDisplay = document.getElementById('userChoiceDisplay');
    const computerChoiceDisplay = document.getElementById('computerChoiceDisplay');
    const resultAlert = document.getElementById('resultAlert');
    const resultText = document.getElementById('resultText');
    
    // –≠–ª–µ–º–µ–Ω—Ç—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    const winsEl = document.getElementById('wins');
    const lossesEl = document.getElementById('losses');
    const drawsEl = document.getElementById('draws');
    
    // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–≥—Ä—ã
    let wins = 0, losses = 0, draws = 0;
    let gameStarted = false;
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–ù–∞—á–∞—Ç—å –∏–≥—Ä—É"
    startGameBtn.addEventListener('click', function() {
        startGame();
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤—ã–±–æ—Ä–∞ —Ö–æ–¥–∞
    choiceBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            if (!gameStarted) return;
            
            const userChoice = this.dataset.choice;
            playRound(userChoice);
        });
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö
    playAgainBtn.addEventListener('click', function() {
        showGameArea();
    });
    
    backToMenuBtn.addEventListener('click', function() {
        resetToStart();
    });
    
    function startGame() {
        gameStarted = true;
        startArea.style.display = 'none';
        startGameBtn.style.display = 'none';
        gameArea.style.display = 'block';
        resultArea.style.display = 'none';
        
        // –°–±—Ä–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–∏ –Ω–æ–≤–æ–º –∑–∞–ø—É—Å–∫–µ
        wins = 0; losses = 0; draws = 0;
        updateStats();
    }
    
    function playRound(userChoice) {
        // –í–æ–∑–º–æ–∂–Ω—ã–µ —Ö–æ–¥—ã
        const choices = ['rock', 'paper', 'scissors'];
        
        // –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
        const computerChoice = choices[Math.floor(Math.random() * 3)];
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
        let result, message, alertClass;
        
        if (userChoice === computerChoice) {
            result = 'draw';
            message = 'ü§ù –ù–∏—á—å—è!';
            alertClass = 'alert-warning';
            draws++;
        } else if (
            (userChoice === 'rock' && computerChoice === 'scissors') ||
            (userChoice === 'scissors' && computerChoice === 'paper') ||
            (userChoice === 'paper' && computerChoice === 'rock')
        ) {
            result = 'win';
            message = 'üéâ –í—ã –ø–æ–±–µ–¥–∏–ª–∏!';
            alertClass = 'alert-success';
            wins++;
        } else {
            result = 'lose';
            message = 'üíª –ö–æ–º–ø—å—é—Ç–µ—Ä –ø–æ–±–µ–¥–∏–ª!';
            alertClass = 'alert-danger';
            losses++;
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        updateStats();
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        showResult(userChoice, computerChoice, message, alertClass);
    }
    
    function updateStats() {
        winsEl.textContent = wins;
        lossesEl.textContent = losses;
        drawsEl.textContent = draws;
    }
    
    function showResult(userChoice, computerChoice, message, alertClass) {
        // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –≤—ã–±–æ—Ä—ã
        const choiceNames = {
            'rock': '‚úä –ö–∞–º–µ–Ω—å',
            'paper': '‚úã –ë—É–º–∞–≥–∞', 
            'scissors': '‚úåÔ∏è –ù–æ–∂–Ω–∏—Ü—ã'
        };
        
        userChoiceDisplay.textContent = choiceNames[userChoice];
        computerChoiceDisplay.textContent = choiceNames[computerChoice];
        
        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∞–ª–µ—Ä—Ç
        resultAlert.className = `alert ${alertClass}`;
        resultText.textContent = message;
        
        // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —ç–∫—Ä–∞–Ω—ã
        gameArea.style.display = 'none';
        resultArea.style.display = 'block';
    }
    
    function showGameArea() {
        gameArea.style.display = 'block';
        resultArea.style.display = 'none';
    }
    
    function resetToStart() {
        gameStarted = false;
        startArea.style.display = 'block';
        startGameBtn.style.display = 'block';
        gameArea.style.display = 'none';
        resultArea.style.display = 'none';
    }
    
    // –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –∫–Ω–æ–ø–æ–∫ –≤—ã–±–æ—Ä–∞
    choiceBtns.forEach(btn => {
        btn.addEventListener('mouseenter', function() {
            this.style.transform = 'scale(1.05)';
        });
        
        btn.addEventListener('mouseleave', function() {
            this.style.transform = 'scale(1)';
        });
    });
});
</script>

<style>
.choice-btn {
    transition: all 0.2s ease;
    min-width: 120px;
}

.choice-btn:hover {
    transform: scale(1.05);
}

#userChoiceDisplay, #computerChoiceDisplay {
    font-size: 2.5rem;
}

.alert {
    border: none;
    border-radius: 15px;
}
</style>
{% endblock %}